<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Album - FootCollect</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a2e;
            color: white;
            text-align: center;
            padding: 20px;
        }

        /* En-t√™te */
        header {
            margin-bottom: 40px;
        }
        h1 { color: #fcdab7; margin-bottom: 5px; }
        .stats { color: #e94560; font-weight: bold; font-size: 1.2rem; }

        /* Bouton retour */
        .btn-back {
            display: inline-block;
            margin-bottom: 20px;
            color: white;
            background-color: #16213e;
            text-decoration: none;
            border: 1px solid #e94560;
            padding: 10px 20px;
            border-radius: 30px;
            transition: 0.3s;
        }
        .btn-back:hover { background-color: #e94560; }

        /* Grille de l'album */
        #album-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        /* --- DESIGN DE LA CARTE --- */
        .card {
            width: 160px;
            height: 240px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            padding: 10px;
            transition: transform 0.2s;
            
            /* Fond par d√©faut (Bleu nuit) */
            background: linear-gradient(180deg, #16213e 0%, #0f3460 100%);
            border: 2px solid #444;
        }
        
        .card:hover { transform: translateY(-5px); z-index: 10; }

        /* Bordures selon la raret√© */
        .card.common { border-color: #a0a0a0; box-shadow: 0 0 5px #a0a0a0; } /* Gris */
        .card.rare { border-color: #00d2ff; box-shadow: 0 0 8px #00d2ff; }   /* Bleu n√©on */
        .card.legendary { 
            border-color: #ffd700; 
            box-shadow: 0 0 15px #ffd700; 
            background: linear-gradient(180deg, #2c2c1e 0%, #5e5008 100%); /* Fond dor√© sombre */
        }

        /* Image du joueur (Cutout) */
        .player-img {
            width: 110px;
            height: 110px;
            object-fit: contain; /* Important pour les images d√©tour√©es */
            object-position: bottom;
            filter: drop-shadow(0px 5px 5px rgba(0,0,0,0.5)); /* Ombre port√©e derri√®re le joueur */
            z-index: 2;
        }

        /* Infos */
        .rating { 
            position: absolute; 
            top: 10px; 
            left: 10px; 
            font-size: 1.4rem; 
            font-weight: 800; 
        }
        .position {
            position: absolute;
            top: 35px;
            left: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            opacity: 0.8;
        }

        h3 { font-size: 0.95rem; margin: 5px 0 0 0; z-index: 2; text-align: center; }
        .team { font-size: 0.75rem; color: #ccc; margin-bottom: 5px; text-align: center; }

        /* Badge quantit√© (x2) */
        .quantity-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: #e94560;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            border: 2px solid #1a1a2e;
            z-index: 20;
        }
    </style>
</head>
<body>

    <header>
        <a href="index.html" class="btn-back">‚¨Ö Retour √† l'ouverture</a>
        <h1>üìö Mon Album</h1>
        <p class="stats">Cartes poss√©d√©es : <span id="count">0</span></p>
    </header>

    <div id="album-container">
        Chargement de ta collection...
    </div>

    <script>
        window.onload = chargerAlbum;

        async function chargerAlbum() {
            const container = document.getElementById('album-container');
            const countSpan = document.getElementById('count');

            try {
                // On appelle ton API (qui va lire la BDD remplie par le script)
                const reponse = await fetch('http://localhost:3000/my-album');
                const mesCartes = await reponse.json();

                container.innerHTML = '';
                countSpan.innerText = mesCartes.length;

                if (mesCartes.length === 0) {
                    container.innerHTML = '<p>Ton album est vide ! Va ouvrir des packs.</p>';
                    return;
                }

                // Affichage des cartes
                mesCartes.forEach(card => {
                    // Gestion de la classe CSS pour la raret√©
                    let rarityClass = 'common';
                    if (card.rarity === 'RARE') rarityClass = 'rare';
                    if (card.rarity === 'LEGENDARY') rarityClass = 'legendary';

                    // Image par d√©faut si le script n'a rien trouv√©
                    const imageSrc = card.image_url || 'https://cdn-icons-png.flaticon.com/512/3048/3048122.png';

                    const cardHTML = `
                        <div class="card ${rarityClass}">
                            ${card.quantity > 1 ? `<div class="quantity-badge">x${card.quantity}</div>` : ''}
                            
                            <div class="rating">${card.rating}</div>
                            <div class="position">${card.position || ''}</div>
                            
                            <img src="${imageSrc}" class="player-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3048/3048122.png'">
                            
                            <div>
                                <h3>${card.name}</h3>
                                <p class="team">${card.team}</p>
                            </div>
                        </div>
                    `;
                    container.innerHTML += cardHTML;
                });

            } catch (erreur) {
                console.error(erreur);
                container.innerHTML = '<p style="color:red">Erreur de chargement. V√©rifie que le serveur tourne !</p>';
            }
        }
    </script>

</body>
</html>